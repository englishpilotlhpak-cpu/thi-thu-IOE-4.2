<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BỘ ĐỀ ÔN IOE K4 SỐ: 01.2</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;700;800&display=swap');
        body {
            font-family: 'Baloo 2', cursive;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .word-block {
            user-select: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        audio {
            filter: sepia(20%) saturate(70%) grayscale(1) contrast(99%) brightness(90%);
        }
    </style>
</head>
<body class="bg-blue-50 font-sans antialiased text-gray-800">
    <div id="root"></div>

    <script type="text/babel">
        // --- DỮ LIỆU CÂU HỎI IOE LỚP 4 (ĐỀ SỐ 01.2) - 100 CÂU ---
        const questions = [
            {
                type: 'mc',
                question: '1. What is the date today?',
                options: [
                    { text: 'A. It’s Sunday.', isCorrect: false },
                    { text: 'B. It’s in July.', isCorrect: false },
                    { text: 'C. It’s April the seventh.', isCorrect: true },
                    { text: 'D. It’s the eleventh.', isCorrect: false }
                ],
                correctAnswer: 'C. It’s April the seventh.',
                correctAnswer_vi: 'Hôm nay là ngày 7 tháng 4.',
                hint_vi: 'Câu hỏi "What is the date?" hỏi về ngày tháng.',
                rationale_vi: 'Câu A trả lời về thứ. Câu B trả lời về tháng. Câu D thiếu tháng. Chỉ có câu C trả lời đầy đủ và đúng cho câu hỏi về ngày tháng.',
                rationale_en: 'Question A answers the day of the week. Question B answers the month. Question D is missing the month. Only C is a complete and correct answer for a date question.'
            },
            {
                type: 'mc',
                question: '2. Tom is my ... too.',
                options: [
                    { text: 'A. he', isCorrect: false },
                    { text: 'B. she', isCorrect: false },
                    { text: 'C. friend', isCorrect: true },
                    { text: 'D. be', isCorrect: false }
                ],
                correctAnswer: 'C. friend',
                correctAnswer_vi: 'bạn',
                hint_vi: 'Cần một danh từ chỉ người.',
                rationale_vi: '"Friend" (bạn) là danh từ phù hợp nhất trong ngữ cảnh này. "he" và "she" là đại từ, "be" là động từ.',
                rationale_en: '"Friend" is the most suitable noun in this context. "he" and "she" are pronouns, and "be" is a verb.'
            },
            {
                type: 'fill-in-the-blank',
                question: '3. What t___ is it? Let\'s go or we will be late for lunch.',
                correctAnswer: 'ime',
                correctAnswer_vi: 'ime',
                hint_vi: 'Từ có nghĩa là "thời gian". (3 ký tự)',
                rationale_vi: 'Câu hỏi "What time is it?" dùng để hỏi giờ. Ngữ cảnh "late for lunch" (muộn bữa trưa) cũng cho thấy đây là câu hỏi về thời gian.',
                rationale_en: 'The question "What time is it?" is used to ask the time. The context "late for lunch" also indicates a question about time.'
            },
            {
                type: 'rearrange',
                question: '4. Linh/ doesn’t like/ playing/ the guitar./',
                words: ['Linh', 'doesn’t like', 'playing', 'the guitar.'],
                correctAnswer: 'Linh doesn’t like playing the guitar.',
                correctAnswer_vi: 'Linh không thích chơi đàn guitar.',
                hint_vi: 'Cấu trúc câu phủ định với "like + V-ing".',
                rationale_vi: 'Câu phủ định ở thì hiện tại đơn với động từ thường: S + doesn’t + V. Sau "like", động từ thường ở dạng V-ing.',
                rationale_en: 'Negative sentence structure in the simple present with a regular verb: S + doesn’t + V. After "like", the verb is in the V-ing form.'
            },
            {
                type: 'mc',
                question: '5. The pictures are ... the wall.',
                options: [
                    { text: 'A. from', isCorrect: false },
                    { text: 'B. to', isCorrect: false },
                    { text: 'C. at', isCorrect: false },
                    { text: 'D. on', isCorrect: true }
                ],
                correctAnswer: 'D. on',
                correctAnswer_vi: 'trên',
                hint_vi: 'Giới từ chỉ vị trí trên một bề mặt.',
                rationale_vi: 'Giới từ "on" được dùng để chỉ vật gì đó đang ở trên bề mặt của một vật khác (trên tường).',
                rationale_en: 'The preposition "on" is used to indicate something is on the surface of another object (on the wall).'
            },
            {
                type: 'fill-in-the-blank',
                question: '6. Would you like an apple? - _o, thanks.',
                correctAnswer: 'N',
                correctAnswer_vi: 'N',
                hint_vi: 'Từ dùng để từ chối. (1 ký tự)',
                rationale_vi: 'Để từ chối một lời mời, ta dùng "No, thanks".',
                rationale_en: 'To decline an offer, we say "No, thanks".'
            },
            {
                type: 'fill-in-the-blank',
                question: '7. Is that your new sch__l? – Yes, it is.',
                correctAnswer: 'oo',
                correctAnswer_vi: 'oo',
                hint_vi: 'Từ có nghĩa là "trường học". (2 ký tự)',
                rationale_vi: 'Từ đúng là "school" (trường học).',
                rationale_en: 'The correct word is "school".'
            },
            {
                type: 'mc',
                question: '8. Can you speak English? - ... .',
                options: [
                    { text: 'A. Yes, I can’t', isCorrect: false },
                    { text: 'B. No, I can', isCorrect: false },
                    { text: 'C. No, I can’t', isCorrect: true },
                    { text: 'D. Yes, I do', isCorrect: false }
                ],
                correctAnswer: 'C. No, I can’t',
                correctAnswer_vi: 'Không, tôi không thể.',
                hint_vi: 'Chọn câu trả lời phù hợp về mặt ngữ pháp.',
                rationale_vi: 'Câu A và B tự mâu thuẫn. Câu D dùng sai trợ động từ ("do" thay vì "can"). Câu C là câu trả lời phủ định đúng ngữ pháp.',
                rationale_en: 'Answers A and B are self-contradictory. Answer D uses the wrong auxiliary verb ("do" instead of "can"). Answer C is the grammatically correct negative response.'
            },
            {
                type: 'mc',
                question: '9. ... you a student? – Yes, I am.',
                options: [
                    { text: 'A. Am', isCorrect: false },
                    { text: 'B. Are', isCorrect: true },
                    { text: 'C. Is', isCorrect: false },
                    { text: 'D. A', isCorrect: false }
                ],
                correctAnswer: 'B. Are',
                correctAnswer_vi: 'Are',
                hint_vi: 'Động từ "to be" đi với chủ ngữ "you".',
                rationale_vi: 'Trong câu hỏi Yes/No, động từ "to be" đi với chủ ngữ "you" là "are".',
                rationale_en: 'In a Yes/No question, the verb "to be" that goes with the subject "you" is "are".'
            },
            {
                type: 'rearrange',
                question: '10. in/ a kite/ the afternoon./ likes flying/ Linh/',
                words: ['Linh', 'likes flying', 'a kite', 'in the afternoon.'],
                correctAnswer: 'Linh likes flying a kite in the afternoon.',
                correctAnswer_vi: 'Linh thích thả diều vào buổi chiều.',
                hint_vi: 'Bắt đầu với "Linh".',
                rationale_vi: 'Cấu trúc câu: S + V-s/es + O + cụm từ chỉ thời gian.',
                rationale_en: 'Sentence structure: S + V-s/es + O + time phrase.'
            },
            {
                type: 'rearrange',
                question: '11. a/ song?/ sing/ Can/ you/',
                words: ['Can', 'you', 'sing', 'a song?'],
                correctAnswer: 'Can you sing a song?',
                correctAnswer_vi: 'Bạn có thể hát một bài hát không?',
                hint_vi: 'Câu hỏi về khả năng.',
                rationale_vi: 'Cấu trúc câu hỏi Yes/No với "can": Can + S + V(nguyên mẫu)?',
                rationale_en: 'Yes/No question structure with "can": Can + S + V(infinitive)?'
            },
            {
                type: 'fill-in-the-blank',
                question: '12. ICE-CRE_M',
                correctAnswer: 'A',
                correctAnswer_vi: 'A',
                hint_vi: 'Từ có nghĩa là "kem". (1 ký tự)',
                rationale_vi: 'Từ đúng là "ICE-CREAM".',
                rationale_en: 'The correct word is "ICE-CREAM".'
            },
            {
                type: 'rearrange',
                question: '13. When/ is/ your birthday,/ Mai?/',
                words: ['When', 'is', 'your birthday,', 'Mai?'],
                correctAnswer: 'When is your birthday, Mai?',
                correctAnswer_vi: 'Khi nào là sinh nhật của bạn vậy Mai?',
                hint_vi: 'Câu hỏi về ngày sinh nhật.',
                rationale_vi: 'Cấu trúc câu hỏi với "When": When + is + ...?',
                rationale_en: 'Question structure with "When": When + is + ...?'
            },
            {
                type: 'fill-in-the-blank',
                question: '14. This is my brother. __s name is David.',
                correctAnswer: 'Hi',
                correctAnswer_vi: 'Hi',
                hint_vi: 'Tính từ sở hữu cho "anh ấy". (2 ký tự)',
                rationale_vi: 'Tính từ sở hữu tương ứng với "my brother" (anh ấy) là "His" (của anh ấy).',
                rationale_en: 'The possessive adjective corresponding to "my brother" (he) is "His".'
            },
            {
                type: 'mc',
                question: '15. Choose the odd one out:',
                options: [
                    { text: 'A. read', isCorrect: false },
                    { text: 'B. write', isCorrect: false },
                    { text: 'C. day', isCorrect: true },
                    { text: 'D. look', isCorrect: false }
                ],
                correctAnswer: 'C. day',
                correctAnswer_vi: 'ngày',
                hint_vi: 'Tìm từ không phải là động từ.',
                rationale_vi: '"read", "write", và "look" là các động từ. "day" là một danh từ.',
                rationale_en: '"read", "write", and "look" are verbs. "day" is a noun.'
            },
            {
                type: 'fill-in-the-blank',
                question: '16. I like to sing a__ dance.',
                correctAnswer: 'nd',
                correctAnswer_vi: 'nd',
                hint_vi: 'Từ có nghĩa là "và". (2 ký tự)',
                rationale_vi: 'Từ "and" (và) dùng để nối hai hành động "sing" và "dance".',
                rationale_en: 'The word "and" is used to connect the two actions "sing" and "dance".'
            },
            {
                type: 'multimedia',
                question: '17. I LIKE ___.',
                mediaType: 'audio',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/Thi_cac_cap/2020-2021/Lop4/Captruong/nghe/D4_9.mp3',
                correctAnswer: 'RUNNING',
                correctAnswer_vi: 'CHẠY BỘ',
                hint_vi: 'Nghe và điền hoạt động yêu thích. (7 ký tự)',
                rationale_vi: 'Bài nghe nói "I like running" (Tôi thích chạy bộ).',
                rationale_en: 'The audio says "I like running".'
            },
            {
                type: 'fill-in-the-blank',
                question: '18. Wh_ does she like Arts?',
                correctAnswer: 'y',
                correctAnswer_vi: 'y',
                hint_vi: 'Từ để hỏi về lý do. (1 ký tự)',
                rationale_vi: 'Từ để hỏi "Why" được dùng để hỏi về lý do.',
                rationale_en: 'The question word "Why" is used to ask for a reason.'
            },
            {
                type: 'mc',
                question: '19. My mother can drive a ... .',
                options: [
                    { text: 'A. book', isCorrect: false },
                    { text: 'B. telephone', isCorrect: false },
                    { text: 'C. car', isCorrect: true },
                    { text: 'D. bicycle', isCorrect: false }
                ],
                correctAnswer: 'C. car',
                correctAnswer_vi: 'xe ô tô',
                hint_vi: 'Động từ "drive" thường đi với phương tiện nào?',
                rationale_vi: 'Động từ "drive" (lái) thường được dùng với "car" (ô tô). Với "bicycle", người ta dùng động từ "ride".',
                rationale_en: 'The verb "drive" is typically used with "car". With "bicycle", the verb "ride" is used.'
            },
            {
                type: 'fill-in-the-blank',
                question: '20. Nam p___s the guitar with his friends on Fridays.',
                correctAnswer: 'lay',
                correctAnswer_vi: 'lay',
                hint_vi: 'Từ có nghĩa là "chơi". (3 ký tự)',
                rationale_vi: 'Cụm từ "play the guitar" có nghĩa là chơi đàn guitar.',
                rationale_en: 'The phrase "play the guitar" means to play the guitar instrument.'
            },
            {
                type: 'mc',
                question: '21. ... you like a candy? – No, thanks.',
                options: [
                    { text: 'A. Who', isCorrect: false },
                    { text: 'B. When', isCorrect: false },
                    { text: 'C. Would', isCorrect: true },
                    { text: 'D. How', isCorrect: false }
                ],
                correctAnswer: 'C. Would',
                correctAnswer_vi: 'Would',
                hint_vi: 'Cấu trúc mời lịch sự.',
                rationale_vi: 'Cấu trúc "Would you like...?" được dùng để đưa ra lời mời một cách lịch sự.',
                rationale_en: 'The structure "Would you like...?" is used to make a polite offer.'
            },
            {
                type: 'mc',
                question: '22. A: Is your school small? B: ..., it is.',
                options: [
                    { text: 'A. No', isCorrect: false },
                    { text: 'B. Yes', isCorrect: true },
                    { text: 'C. Bye', isCorrect: false },
                    { text: 'D. See you.', isCorrect: false }
                ],
                correctAnswer: 'B. Yes',
                correctAnswer_vi: 'Vâng',
                hint_vi: 'Câu trả lời khẳng định.',
                rationale_vi: 'Vế sau "it is" khẳng định câu hỏi, vì vậy câu trả lời phải là "Yes".',
                rationale_en: 'The second part "it is" confirms the question, so the answer must be "Yes".'
            },
            {
                type: 'rearrange',
                question: '23. birthday?/ your/ When/ is/',
                words: ['When', 'is', 'your', 'birthday?'],
                correctAnswer: 'When is your birthday?',
                correctAnswer_vi: 'Khi nào là sinh nhật của bạn?',
                hint_vi: 'Câu hỏi về ngày sinh nhật.',
                rationale_vi: 'Cấu trúc câu hỏi với "When": When + is/are + S?',
                rationale_en: 'Question structure with "When": When + is/are + S?'
            },
            {
                type: 'rearrange',
                question: '24. Day./ Christmas/ on/ My birthday/ is/',
                words: ['My birthday', 'is', 'on', 'Christmas Day.'],
                correctAnswer: 'My birthday is on Christmas Day.',
                correctAnswer_vi: 'Sinh nhật của tôi vào ngày Giáng sinh.',
                hint_vi: 'Giới từ "on" đi với ngày cụ thể.',
                rationale_vi: 'Chúng ta dùng giới từ "on" trước một ngày cụ thể như "Christmas Day".',
                rationale_en: 'We use the preposition "on" before a specific day like "Christmas Day".'
            },
            {
                type: 'multimedia',
                question: '25. Choose the best answer',
                mediaType: 'image',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/Thi_cac_cap/2020-2021/Lop4/Captruong/anh/D2_10.jpg',
                options: [
                    { text: 'A. A rabbit', isCorrect: false },
                    { text: 'B. A lion', isCorrect: false },
                    { text: 'C. A chicken', isCorrect: false },
                    { text: 'D. A guinea pig', isCorrect: true }
                ],
                correctAnswer: 'D. A guinea pig',
                correctAnswer_vi: 'Một con chuột lang',
                hint_vi: 'Đây là con vật gì?',
                rationale_vi: 'Hình ảnh cho thấy một con chuột lang (guinea pig).',
                rationale_en: 'The image shows a guinea pig.'
            },
            {
                type: 'multimedia',
                question: '26. Listen and tick:',
                mediaType: 'audio',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2013/11/21/635206447604044824_Audio.mp3',
                options: [
                    { text: 'A. There are three books under the table.', isCorrect: false },
                    { text: 'B. There are three boats on the table.', isCorrect: true },
                    { text: 'C. There are three books on the table.', isCorrect: false },
                    { text: 'D. There are three boxes on the table.', isCorrect: false }
                ],
                correctAnswer: 'B. There are three boats on the table.',
                correctAnswer_vi: 'Có ba chiếc thuyền trên bàn.',
                hint_vi: 'Nghe kỹ câu được nói.',
                rationale_vi: 'Đoạn audio nói: "There are three boats on the table".',
                rationale_en: 'The audio says: "There are three boats on the table".'
            },
            {
                type: 'multimedia',
                question: '27. Jolly’s got blue ___s.',
                mediaType: 'audio',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/Thi_cac_cap/2020-2021/Lop4/Captruong/nghe/d1_13.mp3',
                correctAnswer: 'eye',
                correctAnswer_vi: 'mắt',
                hint_vi: 'Nghe và điền bộ phận cơ thể. (3 ký tự)',
                rationale_vi: 'Bài nghe miêu tả "Jolly’s got blue eyes" (Jolly có đôi mắt màu xanh).',
                rationale_en: 'The audio describes "Jolly’s got blue eyes".'
            },
            {
                type: 'mc',
                question: '28. ... you swim, Mary? – Yes, I can.',
                options: [
                    { text: 'A. Do', isCorrect: false },
                    { text: 'B. Are', isCorrect: false },
                    { text: 'C. Is', isCorrect: false },
                    { text: 'D. Can', isCorrect: true }
                ],
                correctAnswer: 'D. Can',
                correctAnswer_vi: 'Can',
                hint_vi: 'Câu trả lời là "Yes, I can".',
                rationale_vi: 'Câu trả lời sử dụng trợ động từ "can", vì vậy câu hỏi cũng phải bắt đầu bằng "Can".',
                rationale_en: 'The answer uses the auxiliary verb "can", so the question must also start with "Can".'
            },
            {
                type: 'rearrange',
                question: '29. the year./ December is/ the last month/ of/',
                words: ['December is', 'the last month', 'of', 'the year.'],
                correctAnswer: 'December is the last month of the year.',
                correctAnswer_vi: 'Tháng 12 là tháng cuối cùng của năm.',
                hint_vi: 'Thứ tự các tháng trong năm.',
                rationale_vi: '"the last month of the year" là một cụm từ có nghĩa là "tháng cuối cùng của năm".',
                rationale_en: '"the last month of the year" is a phrase meaning the final month of the year.'
            },
            {
                type: 'mc',
                question: '30. Goodbye, Sam. - ...',
                options: [
                    { text: 'A. Later see you', isCorrect: false },
                    { text: 'B. See you later', isCorrect: true },
                    { text: 'C. See later you', isCorrect: false },
                    { text: 'D. You see later', isCorrect: false }
                ],
                correctAnswer: 'B. See you later',
                correctAnswer_vi: 'Hẹn gặp lại bạn sau',
                hint_vi: 'Cách đáp lại lời chào tạm biệt.',
                rationale_vi: '"See you later" là một cách nói phổ biến để đáp lại lời chào tạm biệt.',
                rationale_en: '"See you later" is a common way to respond to a goodbye.'
            },
            {
                type: 'fill-in-the-blank',
                question: '31. ____ you like to come to the café with me?',
                correctAnswer: 'Would',
                correctAnswer_vi: 'Would',
                hint_vi: 'Một lời mời lịch sự. (5 ký tự)',
                rationale_vi: 'Cấu trúc "Would you like to...?" dùng để mời ai đó làm gì một cách lịch sự.',
                rationale_en: 'The structure "Would you like to...?" is used to politely invite someone to do something.'
            },
            {
                type: 'rearrange',
                question: '32. Is it/ a green/ it isn’t./ kite? – No,/',
                words: ['Is it', 'a green', 'kite?', '– No,', 'it isn’t.'],
                correctAnswer: 'Is it a green kite? – No, it isn’t.',
                correctAnswer_vi: 'Nó có phải là một con diều màu xanh lá không? – Không, không phải.',
                hint_vi: 'Một đoạn hội thoại hỏi-đáp.',
                rationale_vi: 'Đây là một câu hỏi Yes/No và câu trả lời phủ định tương ứng.',
                rationale_en: 'This is a Yes/No question and its corresponding negative answer.'
            },
            {
                type: 'multimedia',
                question: '33. Sally is making a p___ boat.',
                mediaType: 'image',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2018/11/26/636788551089387667_566X320.jpg',
                correctAnswer: 'aper',
                correctAnswer_vi: 'aper',
                hint_vi: 'Con thuyền được làm bằng gì? (4 ký tự)',
                rationale_vi: 'Trong hình, Sally đang làm một chiếc thuyền giấy (paper boat).',
                rationale_en: 'In the picture, Sally is making a paper boat.'
            },
            {
                type: 'fill-in-the-blank',
                question: '34. Today is __ eleventh of October.',
                correctAnswer: 'the',
                correctAnswer_vi: 'the',
                hint_vi: 'Mạo từ đứng trước số thứ tự. (3 ký tự)',
                rationale_vi: 'Chúng ta luôn dùng mạo từ "the" trước các số thứ tự (first, second, eleventh...).',
                rationale_en: 'We always use the article "the" before ordinal numbers (first, second, eleventh...).'
            },
            {
                type: 'mc',
                question: '35. What is Lan’s ___? – She likes reading comics.',
                options: [
                    { text: 'A. hobbies', isCorrect: false },
                    { text: 'B. hobby', isCorrect: true },
                    { text: 'C. favourite', isCorrect: false },
                    { text: 'D. likes', isCorrect: false }
                ],
                correctAnswer: 'B. hobby',
                correctAnswer_vi: 'sở thích',
                hint_vi: 'Câu hỏi về sở thích.',
                rationale_vi: '"Hobby" là danh từ số ít, phù hợp với câu hỏi "What is...?". "Hobbies" là số nhiều, phải đi với "What are...?".',
                rationale_en: '"Hobby" is a singular noun, fitting the question "What is...?". "Hobbies" is plural and would require "What are...?".'
            },
            {
                type: 'rearrange',
                question: '36. bag/ is/ heavy./ Your/ school/',
                words: ['Your', 'school bag', 'is', 'heavy.'],
                correctAnswer: 'Your school bag is heavy.',
                correctAnswer_vi: 'Cặp sách của bạn nặng.',
                hint_vi: 'Miêu tả một đồ vật.',
                rationale_vi: 'Trật tự câu đúng: Cụm danh từ chủ ngữ (Your school bag) + V (is) + Adj (heavy).',
                rationale_en: 'Correct sentence order: Subject noun phrase (Your school bag) + V (is) + Adj (heavy).'
            },
            {
                type: 'multimedia',
                question: '37. They are having ... .',
                mediaType: 'audio',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2013/11/21/635206416493045877_Audio.mp3',
                options: [
                    { text: 'A. breakfast', isCorrect: true },
                    { text: 'B. break', isCorrect: false },
                    { text: 'C. broke', isCorrect: false },
                    { text: 'D. bread', isCorrect: false }
                ],
                correctAnswer: 'A. breakfast',
                correctAnswer_vi: 'bữa sáng',
                hint_vi: 'Nghe và chọn từ đúng.',
                rationale_vi: 'Bài nghe nói "They are having a breakfast" (Họ đang ăn sáng).',
                rationale_en: 'The audio says "They are having a breakfast".'
            },
            {
                type: 'fill-in-the-blank',
                question: '38. Co_e here, please.',
                correctAnswer: 'm',
                correctAnswer_vi: 'm',
                hint_vi: 'Từ có nghĩa là "đến đây". (1 ký tự)',
                rationale_vi: 'Cụm từ "Come here" có nghĩa là "lại đây".',
                rationale_en: 'The phrase "Come here" means to move to this location.'
            },
            {
                type: 'rearrange',
                question: '39. have/ do you/ What/ your school bag?/ in/',
                words: ['What', 'do you', 'have', 'in', 'your school bag?'],
                correctAnswer: 'What do you have in your school bag?',
                correctAnswer_vi: 'Bạn có gì trong cặp sách của mình?',
                hint_vi: 'Câu hỏi với "What".',
                rationale_vi: 'Cấu trúc câu hỏi: What + do/does + S + V + ...?',
                rationale_en: 'Question structure: What + do/does + S + V + ...?'
            },
            {
                type: 'rearrange',
                question: '40. repeat./ listen/ and/ Look,/',
                words: ['Look,', 'listen', 'and', 'repeat.'],
                correctAnswer: 'Look, listen and repeat.',
                correctAnswer_vi: 'Nhìn, nghe và lặp lại.',
                hint_vi: 'Đây là một lời hướng dẫn.',
                rationale_vi: 'Đây là một chuỗi các động từ mệnh lệnh thường được giáo viên sử dụng.',
                rationale_en: 'This is a series of imperative verbs commonly used by teachers.'
            },
            {
                type: 'mc',
                question: '41. I’m from England. I can speak ... .',
                options: [
                    { text: 'A. Vietnam', isCorrect: false },
                    { text: 'B. France', isCorrect: false },
                    { text: 'C. English', isCorrect: true },
                    { text: 'D. America', isCorrect: false }
                ],
                correctAnswer: 'C. English',
                correctAnswer_vi: 'Tiếng Anh',
                hint_vi: 'Người đến từ England nói tiếng gì?',
                rationale_vi: 'Người từ England (nước Anh) nói tiếng Anh (English).',
                rationale_en: 'People from England speak English.'
            },
            {
                type: 'mc',
                question: '42. Choose the correct order.',
                options: [
                    { text: 'A. Tuesday – Monday – Wednesday – Thursday – Friday', isCorrect: false },
                    { text: 'B. Monday – Wednesday – Thursday – Tuesday – Friday', isCorrect: false },
                    { text: 'C. Monday – Tuesday – Wednesday – Thursday – Friday', isCorrect: true },
                    { text: 'D. Friday – Thursday – Tuesday – Wednesday – Monday', isCorrect: false }
                ],
                correctAnswer: 'C. Monday – Tuesday – Wednesday – Thursday – Friday',
                correctAnswer_vi: 'Thứ Hai - Thứ Ba - Thứ Tư - Thứ Năm - Thứ Sáu',
                hint_vi: 'Thứ tự các ngày trong tuần.',
                rationale_vi: 'Đây là thứ tự đúng của các ngày trong tuần từ thứ Hai đến thứ Sáu.',
                rationale_en: 'This is the correct order of the weekdays from Monday to Friday.'
            },
            {
                type: 'fill-in-the-blank',
                question: '43. My fav_____ite subject is Art.',
                correctAnswer: 'our',
                correctAnswer_vi: 'our',
                hint_vi: 'Từ có nghĩa là "yêu thích". (3 ký tự)',
                rationale_vi: 'Từ đúng là "favourite" (yêu thích).',
                rationale_en: 'The correct word is "favourite".'
            },
            {
                type: 'mc',
                question: '44. What toys do you have? – I have three ______ and one ______.',
                options: [
                    { text: 'A. teddy bears – train', isCorrect: true },
                    { text: 'B. teddys bear – ship', isCorrect: false },
                    { text: 'C. teddys bear – dolls', isCorrect: false },
                    { text: 'D. teddy bear - robots', isCorrect: false }
                ],
                correctAnswer: 'A. teddy bears – train',
                correctAnswer_vi: 'gấu bông - tàu hỏa',
                hint_vi: 'Chú ý số ít và số nhiều.',
                rationale_vi: '"Three" đi với danh từ số nhiều (teddy bears) và "one" đi với danh từ số ít (train). Các phương án khác sai về dạng số nhiều hoặc không hợp lý.',
                rationale_en: '"Three" goes with a plural noun (teddy bears) and "one" goes with a singular noun (train). Other options are incorrect in plural form or logic.'
            },
            {
                type: 'fill-in-the-blank',
                question: '45. Happy bi___day to you, Nam.',
                correctAnswer: 'rth',
                correctAnswer_vi: 'rth',
                hint_vi: 'Từ có nghĩa là "sinh nhật". (3 ký tự)',
                rationale_vi: 'Từ đúng là "birthday" (sinh nhật).',
                rationale_en: 'The correct word is "birthday".'
            },
            {
                type: 'fill-in-the-blank',
                question: '46. Do you have ___ sisters? - Yes, I have two sisters.',
                correctAnswer: 'any',
                correctAnswer_vi: 'any',
                hint_vi: 'Từ dùng trong câu hỏi và câu phủ định. (3 ký tự)',
                rationale_vi: '"Any" thường được dùng trong câu hỏi nghi vấn và câu phủ định để hỏi về sự tồn tại của một số lượng không xác định.',
                rationale_en: '"Any" is typically used in questions and negative sentences to ask about an unspecified quantity.'
            },
            {
                type: 'rearrange',
                question: '47. to 8 a.m/ studies Maths/ on Sunday./ Mary/ from 7 a.m/',
                words: ['Mary', 'studies Maths', 'from 7 a.m', 'to 8 a.m', 'on Sunday.'],
                correctAnswer: 'Mary studies Maths from 7 a.m to 8 a.m on Sunday.',
                correctAnswer_vi: 'Mary học Toán từ 7 giờ sáng đến 8 giờ sáng vào Chủ nhật.',
                hint_vi: 'Cấu trúc "from... to...".',
                rationale_vi: 'Cấu trúc "from [thời gian bắt đầu] to [thời gian kết thúc]" dùng để chỉ một khoảng thời gian.',
                rationale_en: 'The structure "from [start time] to [end time]" is used to indicate a period of time.'
            },
            {
                type: 'mc',
                question: '48. Choose the odd one out',
                options: [
                    { text: 'A. Painted', isCorrect: true },
                    { text: 'B. Wash', isCorrect: false },
                    { text: 'C. Cook', isCorrect: false },
                    { text: 'D. Look', isCorrect: false }
                ],
                correctAnswer: 'A. Painted',
                correctAnswer_vi: 'Đã sơn/vẽ',
                hint_vi: 'Tìm từ khác loại về thì/dạng.',
                rationale_vi: '"Wash", "Cook", và "Look" là các động từ nguyên mẫu. "Painted" là động từ ở dạng quá khứ hoặc quá khứ phân từ.',
                rationale_en: '"Wash", "Cook", and "Look" are base form verbs. "Painted" is a verb in the past or past participle form.'
            },
            {
                type: 'fill-in-the-blank',
                question: '49. Brian is getting dr_____ in his room.',
                correctAnswer: 'essed',
                correctAnswer_vi: 'essed',
                hint_vi: 'Cụm từ "thay quần áo". (5 ký tự)',
                rationale_vi: 'Cụm động từ "get dressed" có nghĩa là mặc quần áo.',
                rationale_en: 'The phrasal verb "get dressed" means to put on clothes.'
            },
            {
                type: 'rearrange',
                question: '50. balloons/ very much./ I like/ and flowers/',
                words: ['I like', 'balloons', 'and flowers', 'very much.'],
                correctAnswer: 'I like balloons and flowers very much.',
                correctAnswer_vi: 'Tôi rất thích bóng bay và hoa.',
                hint_vi: 'Câu nói về sở thích.',
                rationale_vi: '"very much" thường đứng ở cuối câu để nhấn mạnh.',
                rationale_en: '"very much" usually comes at the end of the sentence for emphasis.'
            },
            {
                type: 'mc',
                question: '51. How’s ... weather today? - It’s hot today.',
                options: [
                    { text: 'A. a', isCorrect: false },
                    { text: 'B. an', isCorrect: false },
                    { text: 'C. the', isCorrect: true },
                    { text: 'D. my', isCorrect: false }
                ],
                correctAnswer: 'C. the',
                correctAnswer_vi: 'the',
                hint_vi: 'Mạo từ xác định.',
                rationale_vi: 'Chúng ta dùng "the weather" vì đang nói về một khái niệm cụ thể, xác định (thời tiết của hôm nay).',
                rationale_en: 'We use "the weather" because we are talking about a specific, definite concept (today\'s weather).'
            },
            {
                type: 'rearrange',
                question: '52. have/ daughters?/ he/ Does/ two/',
                words: ['Does', 'he', 'have', 'two', 'daughters?'],
                correctAnswer: 'Does he have two daughters?',
                correctAnswer_vi: 'Anh ấy có hai cô con gái phải không?',
                hint_vi: 'Câu hỏi Yes/No ở thì hiện tại đơn.',
                rationale_vi: 'Cấu trúc câu hỏi: Does + S (ngôi thứ ba số ít) + V(nguyên mẫu)?',
                rationale_en: 'Question structure: Does + S (third-person singular) + V(infinitive)?'
            },
            {
                type: 'fill-in-the-blank',
                question: '53. My ____ town is Hanoi.',
                correctAnswer: 'home',
                correctAnswer_vi: 'home',
                hint_vi: 'Cụm từ có nghĩa là "quê nhà". (4 ký tự)',
                rationale_vi: 'Cụm từ "hometown" có nghĩa là quê hương, thành phố quê nhà.',
                rationale_en: 'The phrase "hometown" refers to one\'s native town or city.'
            },
            {
                type: 'mc',
                question: '54. Which word has the underlined part pronounced differently from the letter ‘o’ in ’’hot’’?',
                options: [
                    { text: 'A. dog', isCorrect: false },
                    { text: 'B. clock', isCorrect: false },
                    { text: 'C. doctor', isCorrect: false },
                    { text: 'D. old', isCorrect: true }
                ],
                correctAnswer: 'D. old',
                correctAnswer_vi: 'cũ, già',
                hint_vi: 'So sánh âm /ɒ/ với các âm khác.',
                rationale_vi: 'Âm "o" trong "hot", "dog", "clock", "doctor" được phát âm là /ɒ/. Âm "o" trong "old" được phát âm là /əʊ/.',
                rationale_en: 'The "o" sound in "hot", "dog", "clock", "doctor" is pronounced /ɒ/. The "o" sound in "old" is pronounced /əʊ/.'
            },
            {
                type: 'rearrange',
                question: '55. dance/ can/ She/ well./ sing and/',
                words: ['She', 'can', 'sing', 'and', 'dance', 'well.'],
                correctAnswer: 'She can sing and dance well.',
                correctAnswer_vi: 'Cô ấy có thể hát và nhảy giỏi.',
                hint_vi: 'Câu nói về khả năng.',
                rationale_vi: 'Cấu trúc: S + can + V1 + and + V2 + (adv).',
                rationale_en: 'Structure: S + can + V1 + and + V2 + (adv).'
            },
            {
                type: 'multimedia',
                question: '56. He is writing a le___r.',
                mediaType: 'image',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2019/11/27/637104528619836069_566X320.jpg',
                correctAnswer: 'tte',
                correctAnswer_vi: 'tte',
                hint_vi: 'Từ có nghĩa là "lá thư". (3 ký tự)',
                rationale_vi: 'Từ đúng là "letter" (lá thư).',
                rationale_en: 'The correct word is "letter".'
            },
            {
                type: 'fill-in-the-blank',
                question: '57. W__ did you meet? - Some famous musicians.',
                correctAnswer: 'ho',
                correctAnswer_vi: 'ho',
                hint_vi: 'Từ để hỏi về người. (2 ký tự)',
                rationale_vi: 'Câu trả lời là "some famous musicians" (một vài nhạc sĩ nổi tiếng), là người, vì vậy từ để hỏi phải là "Who".',
                rationale_en: 'The answer is "some famous musicians", which refers to people, so the question word must be "Who".'
            },
            {
                type: 'fill-in-the-blank',
                question: '58. BE__USE',
                correctAnswer: 'CA',
                correctAnswer_vi: 'CA',
                hint_vi: 'Từ có nghĩa là "bởi vì". (2 ký tự)',
                rationale_vi: 'Từ đúng là "BECAUSE".',
                rationale_en: 'The correct word is "BECAUSE".'
            },
            {
                type: 'multimedia',
                question: '59. Elsa is beautiful in her b___ dress.',
                mediaType: 'image',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2018/11/30/636791967023464646_566X320.jpg',
                correctAnswer: 'lue',
                correctAnswer_vi: 'lue',
                hint_vi: 'Màu sắc của chiếc váy. (3 ký tự)',
                rationale_vi: 'Elsa nổi tiếng với chiếc váy màu xanh dương (blue).',
                rationale_en: 'Elsa is famous for her blue dress.'
            },
            {
                type: 'fill-in-the-blank',
                question: '60. What is your fav_____te subject?',
                correctAnswer: 'ouri',
                correctAnswer_vi: 'ouri',
                hint_vi: 'Từ có nghĩa là "yêu thích". (4 ký tự)',
                rationale_vi: 'Từ đúng là "favourite" (yêu thích).',
                rationale_en: 'The correct word is "favourite".'
            },
            {
                type: 'fill-in-the-blank',
                question: '61. There is an era__r on the desk.',
                correctAnswer: 'se',
                correctAnswer_vi: 'se',
                hint_vi: 'Từ có nghĩa là "cục tẩy". (2 ký tự)',
                rationale_vi: 'Từ đúng là "eraser" (cục tẩy).',
                rationale_en: 'The correct word is "eraser".'
            },
            {
                type: 'fill-in-the-blank',
                question: '62. Is that your eraser? No, it is ___ .',
                correctAnswer: 'not',
                correctAnswer_vi: 'not',
                hint_vi: 'Từ dùng trong câu phủ định. (3 ký tự)',
                rationale_vi: 'Cách trả lời đầy đủ cho câu hỏi Yes/No phủ định là "No, it is not." hoặc "No, it isn\'t."',
                rationale_en: 'The full negative answer to a Yes/No question is "No, it is not." or "No, it isn\'t."'
            },
            {
                type: 'fill-in-the-blank',
                question: '63. My little sister is ___ching “Tom & Jerry” in the bedroom.',
                correctAnswer: 'wat',
                correctAnswer_vi: 'wat',
                hint_vi: 'Từ có nghĩa là "xem". (3 ký tự)',
                rationale_vi: 'Từ "watching" có nghĩa là đang xem (phim, TV).',
                rationale_en: 'The word "watching" means currently viewing (a movie, TV).'
            },
            {
                type: 'mc',
                question: '64. Wow, you ___ a lot of interesting books.',
                options: [
                    { text: 'A. having', isCorrect: false },
                    { text: 'B. doesn’t have', isCorrect: false },
                    { text: 'C. have', isCorrect: true },
                    { text: 'D. has', isCorrect: false }
                ],
                correctAnswer: 'C. have',
                correctAnswer_vi: 'có',
                hint_vi: 'Động từ đi với chủ ngữ "you".',
                rationale_vi: 'Chủ ngữ là "you" nên động từ "have" ở dạng nguyên mẫu.',
                rationale_en: 'The subject is "you", so the verb "have" is in its base form.'
            },
            {
                type: 'mc',
                question: '65. A: … - B: It’s Friday.',
                options: [
                    { text: 'A. What is the date today?', isCorrect: false },
                    { text: 'B. When is your birthday?', isCorrect: false },
                    { text: 'C. How are you today?', isCorrect: false },
                    { text: 'D. What day is it today?', isCorrect: true }
                ],
                correctAnswer: 'D. What day is it today?',
                correctAnswer_vi: 'Hôm nay là thứ mấy?',
                hint_vi: 'Câu trả lời là "thứ Sáu".',
                rationale_vi: 'Câu hỏi "What day is it today?" dùng để hỏi về thứ trong tuần. Câu trả lời "It\'s Friday" (Hôm nay là thứ Sáu) hoàn toàn phù hợp.',
                rationale_en: 'The question "What day is it today?" is used to ask about the day of the week. The answer "It\'s Friday" is a perfect match.'
            },
            {
                type: 'mc',
                question: '66. What ... do you have today? – Today I have Music and Maths.',
                options: [
                    { text: 'A. names', isCorrect: false },
                    { text: 'B. times', isCorrect: false },
                    { text: 'C. subjects', isCorrect: true },
                    { text: 'D. school', isCorrect: false }
                ],
                correctAnswer: 'C. subjects',
                correctAnswer_vi: 'môn học',
                hint_vi: 'Music và Maths là các...',
                rationale_vi: 'Music (Âm nhạc) và Maths (Toán) là các môn học (subjects).',
                rationale_en: 'Music and Maths are school subjects.'
            },
            {
                type: 'multimedia',
                question: '67. My parents took me to the ___ last weekend.',
                mediaType: 'image',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2018/1/3/636505721085262204_566X320.jpg',
                correctAnswer: 'zoo',
                correctAnswer_vi: 'sở thú',
                hint_vi: 'Nơi có nhiều động vật. (3 ký tự)',
                rationale_vi: 'Hình ảnh có các con vật như hổ, voi, khỉ... cho thấy đây là sở thú (zoo).',
                rationale_en: 'The image shows animals like tigers, elephants, monkeys... indicating it is a zoo.'
            },
            {
                type: 'multimedia',
                question: '68. Where’s Jack?',
                mediaType: 'audio',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2018/11/29/636790851896563619_Audio.mp3',
                options: [
                    { text: 'A. He’s in New York.', isCorrect: false },
                    { text: 'B. He’s in Tokyo.', isCorrect: false },
                    { text: 'C. He’s in London.', isCorrect: true },
                    { text: 'D. He’s in Hanoi.', isCorrect: false }
                ],
                correctAnswer: 'C. He’s in London.',
                correctAnswer_vi: 'Anh ấy ở London.',
                hint_vi: 'Nghe và xác định địa điểm.',
                rationale_vi: 'Bài nghe trả lời cho câu hỏi "Where\'s Jack?" là "He\'s in London."',
                rationale_en: 'The audio answer to "Where\'s Jack?" is "He\'s in London."'
            },
            {
                type: 'multimedia',
                question: '69. A f___ can swim but it can’t walk.',
                mediaType: 'image',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2018/1/3/636505719250571212_566X320.jpg',
                correctAnswer: 'ish',
                correctAnswer_vi: 'ish',
                hint_vi: 'Con vật sống dưới nước. (3 ký tự)',
                rationale_vi: 'Con vật trong hình là con cá (fish).',
                rationale_en: 'The animal in the picture is a fish.'
            },
            {
                type: 'rearrange',
                question: '70. Welcome/ Come/ to my/ in./ house./',
                words: ['Welcome', 'to my', 'house.', 'Come', 'in.'],
                correctAnswer: 'Welcome to my house. Come in.',
                correctAnswer_vi: 'Chào mừng đến nhà tôi. Mời vào.',
                hint_vi: 'Một lời chào mời khách.',
                rationale_vi: 'Đây là hai câu ngắn dùng để chào đón khách vào nhà.',
                rationale_en: 'These are two short sentences used to welcome a guest into one\'s home.'
            },
            {
                type: 'mc',
                question: '71. I … my teeth in the morning.',
                options: [
                    { text: 'A. do', isCorrect: false },
                    { text: 'B. clean', isCorrect: false },
                    { text: 'C. have', isCorrect: false },
                    { text: 'D. brush', isCorrect: true }
                ],
                correctAnswer: 'D. brush',
                correctAnswer_vi: 'đánh',
                hint_vi: 'Hành động làm sạch răng bằng bàn chải.',
                rationale_vi: 'Cụm từ cố định là "brush my teeth" (đánh răng).',
                rationale_en: 'The fixed phrase is "brush my teeth".'
            },
            {
                type: 'rearrange',
                question: '72. my house./ There are/ four/ rooms/ in/',
                words: ['There are', 'four', 'rooms', 'in', 'my house.'],
                correctAnswer: 'There are four rooms in my house.',
                correctAnswer_vi: 'Có bốn phòng trong nhà của tôi.',
                hint_vi: 'Bắt đầu với "There are".',
                rationale_vi: 'Cấu trúc "There are" dùng để chỉ sự tồn tại của danh từ số nhiều (four rooms).',
                rationale_en: 'The structure "There are" is used to indicate the existence of plural nouns (four rooms).'
            },
            {
                type: 'fill-in-the-blank',
                question: '73. His car is wh_te.',
                correctAnswer: 'i',
                correctAnswer_vi: 'i',
                hint_vi: 'Từ chỉ màu trắng. (1 ký tự)',
                rationale_vi: 'Từ đúng là "white" (màu trắng).',
                rationale_en: 'The correct word is "white".'
            },
            {
                type: 'mc',
                question: '74. When is your brother’s birthday? - … .',
                options: [
                    { text: 'A. It’s July', isCorrect: false },
                    { text: 'B. It’s in July', isCorrect: true },
                    { text: 'C. It July', isCorrect: false },
                    { text: 'D. It’s on July', isCorrect: false }
                ],
                correctAnswer: 'B. It’s in July',
                correctAnswer_vi: 'Vào tháng Bảy.',
                hint_vi: 'Giới từ đi với tháng.',
                rationale_vi: 'Khi chỉ nói về tháng, chúng ta dùng giới từ "in". Khi nói về ngày cụ thể, chúng ta dùng "on".',
                rationale_en: 'When talking only about a month, we use the preposition "in". When talking about a specific date, we use "on".'
            },
            {
                type: 'fill-in-the-blank',
                question: '75. His sister is t__l but he is short.',
                correctAnswer: 'al',
                correctAnswer_vi: 'al',
                hint_vi: 'Từ miêu tả chiều cao, trái nghĩa với "short". (2 ký tự)',
                rationale_vi: 'Từ "tall" (cao) trái nghĩa với "short" (thấp).',
                rationale_en: 'The word "tall" is the opposite of "short".'
            },
            {
                type: 'mc',
                question: '76. ... is she? – She is my teacher.',
                options: [
                    { text: 'A. Who', isCorrect: true },
                    { text: 'B. What', isCorrect: false },
                    { text: 'C. Which', isCorrect: false },
                    { text: 'D. Where', isCorrect: false }
                ],
                correctAnswer: 'A. Who',
                correctAnswer_vi: 'Ai',
                hint_vi: 'Câu hỏi về người.',
                rationale_vi: 'Câu trả lời "She is my teacher" (Cô ấy là giáo viên của tôi) chỉ một người, vì vậy từ để hỏi phải là "Who".',
                rationale_en: 'The answer "She is my teacher" refers to a person, so the question word must be "Who".'
            },
            {
                type: 'rearrange',
                question: '77. then/ sit down./ and/ Read/ aloud/',
                words: ['Read', 'aloud', 'and', 'then', 'sit down.'],
                correctAnswer: 'Read aloud and then sit down.',
                correctAnswer_vi: 'Đọc to và sau đó ngồi xuống.',
                hint_vi: 'Một chuỗi hướng dẫn.',
                rationale_vi: 'Đây là một chuỗi các mệnh lệnh, chỉ thứ tự các hành động cần làm.',
                rationale_en: 'This is a sequence of commands, indicating the order of actions to be performed.'
            },
            {
                type: 'fill-in-the-blank',
                question: '78. Mai and Lam are reading a comic book __ the classroom.',
                correctAnswer: 'in',
                correctAnswer_vi: 'in',
                hint_vi: 'Giới từ chỉ vị trí "bên trong". (2 ký tự)',
                rationale_vi: 'Giới từ "in" dùng để chỉ vị trí bên trong một không gian (trong lớp học).',
                rationale_en: 'The preposition "in" is used to indicate a location inside a space (in the classroom).'
            },
            {
                type: 'multimedia',
                question: '79. She tells her friend to come to her house at 7 o’clock on ___.',
                mediaType: 'audio',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2016/12/1/636161992745323604_Audio.mp3',
                correctAnswer: 'Saturday',
                correctAnswer_vi: 'thứ Bảy',
                hint_vi: 'Nghe và điền thứ trong tuần. (8 ký tự)',
                rationale_vi: 'Bài nghe có đoạn hội thoại mời bạn đến nhà vào thứ Bảy (Saturday).',
                rationale_en: 'The audio contains a conversation inviting a friend over on Saturday.'
            },
            {
                type: 'multimedia',
                question: '80. An anaconda is _______.',
                mediaType: 'audio',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2018/11/29/636790908088568561_Audio.mp3',
                options: [
                    { text: 'A. a snake', isCorrect: true },
                    { text: 'B. a fish', isCorrect: false },
                    { text: 'C. a big cat', isCorrect: false },
                    { text: 'D. a bird', isCorrect: false }
                ],
                correctAnswer: 'A. a snake',
                correctAnswer_vi: 'một con rắn',
                hint_vi: 'Nghe mô tả về con trăn anaconda.',
                rationale_vi: 'Bài nghe giới thiệu anaconda là một loại rắn (a snake).',
                rationale_en: 'The audio introduces the anaconda as a type of snake.'
            },
            {
                type: 'rearrange',
                question: '81. volleyball with/ is playing/ her friends./ Mai’s sister/',
                words: ['Mai’s sister', 'is playing', 'volleyball with', 'her friends.'],
                correctAnswer: 'Mai’s sister is playing volleyball with her friends.',
                correctAnswer_vi: 'Chị gái của Mai đang chơi bóng chuyền với bạn của cô ấy.',
                hint_vi: 'Thì hiện tại tiếp diễn.',
                rationale_vi: 'Cấu trúc: S + is/are + V-ing + O.',
                rationale_en: 'Structure: S + is/are + V-ing + O.'
            },
            {
                type: 'multimedia',
                question: '82. ____',
                mediaType: 'audio',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2019/11/28/637105365980815183_Audio.mp3',
                correctAnswer: 'doll',
                correctAnswer_vi: 'búp bê',
                hint_vi: 'Nghe và đánh vần từ. (4 ký tự)',
                rationale_vi: 'Bài nghe đánh vần từ D-O-L-L, có nghĩa là "búp bê".',
                rationale_en: 'The audio spells out D-O-L-L, which means "doll".'
            },
            {
                type: 'rearrange',
                question: '83. you/ some/ Would/ like/ milk?/',
                words: ['Would', 'you', 'like', 'some', 'milk?'],
                correctAnswer: 'Would you like some milk?',
                correctAnswer_vi: 'Bạn có muốn uống một ít sữa không?',
                hint_vi: 'Một lời mời.',
                rationale_vi: 'Cấu trúc mời lịch sự: Would you like + some + N?',
                rationale_en: 'Polite offer structure: Would you like + some + N?'
            },
            {
                type: 'fill-in-the-blank',
                question: '84. It is rai_y in Hanoi today.',
                correctAnswer: 'n',
                correctAnswer_vi: 'n',
                hint_vi: 'Từ miêu tả thời tiết "có mưa". (1 ký tự)',
                rationale_vi: 'Từ đúng là "rainy" (có mưa).',
                rationale_en: 'The correct word is "rainy".'
            },
            {
                type: 'mc',
                question: '85. Which word is a day of a week?',
                options: [
                    { text: 'A. Thusday', isCorrect: false },
                    { text: 'B. Thurday', isCorrect: false },
                    { text: 'C. Thusrday', isCorrect: false },
                    { text: 'D. Thursday', isCorrect: true }
                ],
                correctAnswer: 'D. Thursday',
                correctAnswer_vi: 'Thứ Năm',
                hint_vi: 'Tìm từ được viết đúng chính tả.',
                rationale_vi: '"Thursday" là cách viết đúng của "Thứ Năm". Các lựa chọn khác đều sai chính tả.',
                rationale_en: '"Thursday" is the correct spelling for the day of the week. The other options are misspelled.'
            },
            {
                type: 'fill-in-the-blank',
                question: '86. Last weekend, we played volleyball __ the beach.',
                correctAnswer: 'on',
                correctAnswer_vi: 'on',
                hint_vi: 'Giới từ chỉ vị trí trên bãi biển. (2 ký tự)',
                rationale_vi: 'Chúng ta dùng giới từ "on" với "the beach" (trên bãi biển).',
                rationale_en: 'We use the preposition "on" with "the beach".'
            },
            {
                type: 'rearrange',
                question: '87. is/ in Hanoi./ “Lang Bac”/',
                words: ['“Lang Bac”', 'is', 'in Hanoi.'],
                correctAnswer: '“Lang Bac” is in Hanoi.',
                correctAnswer_vi: 'Lăng Bác ở Hà Nội.',
                hint_vi: 'Câu nói về một địa danh.',
                rationale_vi: 'Đây là câu giới thiệu vị trí của Lăng Bác.',
                rationale_en: 'This is a sentence stating the location of "Lang Bac".'
            },
            {
                type: 'fill-in-the-blank',
                question: '88. Let’s listen __ some music.',
                correctAnswer: 'to',
                correctAnswer_vi: 'to',
                hint_vi: 'Cụm động từ "listen to". (2 ký tự)',
                rationale_vi: 'Cụm động từ cố định là "listen to" (lắng nghe).',
                rationale_en: 'The fixed phrasal verb is "listen to".'
            },
            {
                type: 'rearrange',
                question: '89. school./ works/ in a/ small/ She/',
                words: ['She', 'works', 'in a', 'small', 'school.'],
                correctAnswer: 'She works in a small school.',
                correctAnswer_vi: 'Cô ấy làm việc trong một ngôi trường nhỏ.',
                hint_vi: 'Câu miêu tả công việc.',
                rationale_vi: 'Cấu trúc câu: S + V-s/es + cụm từ chỉ nơi chốn.',
                rationale_en: 'Sentence structure: S + V-s/es + prepositional phrase of place.'
            },
            {
                type: 'rearrange',
                question: '90. is/ vase/ flower/ This/ beautiful./',
                words: ['This', 'flower', 'vase', 'is', 'beautiful.'],
                correctAnswer: 'This flower vase is beautiful.',
                correctAnswer_vi: 'Bình hoa này đẹp.',
                hint_vi: 'Cụm từ "flower vase" có nghĩa là "bình hoa".',
                rationale_vi: 'Câu miêu tả một đồ vật: S (This flower vase) + V (is) + Adj (beautiful).',
                rationale_en: 'Sentence describing an object: S (This flower vase) + V (is) + Adj (beautiful).'
            },
            {
                type: 'rearrange',
                question: '91. today?/ weather/ What’s/ like/ the/',
                words: ['What’s', 'the weather', 'like', 'today?'],
                correctAnswer: 'What’s the weather like today?',
                correctAnswer_vi: 'Thời tiết hôm nay thế nào?',
                hint_vi: 'Câu hỏi về thời tiết.',
                rationale_vi: 'Cấu trúc hỏi về thời tiết: What + be + the weather + like?',
                rationale_en: 'Structure for asking about the weather: What + be + the weather + like?'
            },
            {
                type: 'multimedia',
                question: '92. Oh, no! I don’t have any potato c__ps.',
                mediaType: 'audio',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/Thi%20Th%E1%BB%AD/Thi_trai_nghiem_2021/Lop4/Nghe/E4_1.mp3',
                correctAnswer: 'hi',
                correctAnswer_vi: 'hi',
                hint_vi: 'Nghe và điền từ còn thiếu. (2 ký tự)',
                rationale_vi: 'Bài nghe nói "I don’t have any potato chips" (Tôi không có khoai tây chiên).',
                rationale_en: 'The audio says "I don’t have any potato chips".'
            },
            {
                type: 'fill-in-the-blank',
                question: '93. Ha can dance ___ cannot play football.',
                correctAnswer: 'but',
                correctAnswer_vi: 'but',
                hint_vi: 'Từ nối chỉ sự đối lập. (3 ký tự)',
                rationale_vi: 'Liên từ "but" (nhưng) được dùng để nối hai mệnh đề có ý nghĩa tương phản.',
                rationale_en: 'The conjunction "but" is used to connect two clauses with contrasting ideas.'
            },
            {
                type: 'fill-in-the-blank',
                question: '94. September is the n____ month of the year.',
                correctAnswer: 'inth',
                correctAnswer_vi: 'inth',
                hint_vi: 'Tháng 9 là tháng thứ mấy? (4 ký tự)',
                rationale_vi: 'Tháng Chín (September) là tháng thứ chín (ninth) trong năm.',
                rationale_en: 'September is the ninth month of the year.'
            },
            {
                type: 'fill-in-the-blank',
                question: '95. My toys are in that b_x.',
                correctAnswer: 'o',
                correctAnswer_vi: 'o',
                hint_vi: 'Từ có nghĩa là "cái hộp". (1 ký tự)',
                rationale_vi: 'Từ đúng là "box" (cái hộp).',
                rationale_en: 'The correct word is "box".'
            },
            {
                type: 'multimedia',
                question: '96. Choose the best answer',
                mediaType: 'audio',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/Thi%20Th%E1%BB%AD/Thi_trai_nghiem_2021/Lop4/Nghe/E4_2(2).mp3',
                options: [
                    { text: 'A. Do you want some grape?', isCorrect: false },
                    { text: 'B. Do you want some grapes?', isCorrect: true },
                    { text: 'C. Do you want some chips?', isCorrect: false },
                    { text: 'D. Do you want some great?', isCorrect: false }
                ],
                correctAnswer: 'B. Do you want some grapes?',
                correctAnswer_vi: 'Bạn có muốn ăn nho không?',
                hint_vi: 'Nghe kỹ câu hỏi.',
                rationale_vi: 'Bài nghe hỏi "Do you want some grapes?". "grapes" là danh từ số nhiều.',
                rationale_en: 'The audio asks "Do you want some grapes?". "grapes" is a plural noun.'
            },
            {
                type: 'mc',
                question: '97. How many ... are there in your house? – Only one.',
                options: [
                    { text: 'A. television', isCorrect: false },
                    { text: 'B. televisions', isCorrect: true },
                    { text: 'C. televisiones', isCorrect: false },
                    { text: 'D. television’s', isCorrect: false }
                ],
                correctAnswer: 'B. televisions',
                correctAnswer_vi: 'TV',
                hint_vi: 'Câu hỏi "How many" đi với danh từ số nhiều.',
                rationale_vi: 'Câu hỏi "How many" và động từ "are" yêu cầu một danh từ ở dạng số nhiều. Mặc dù câu trả lời là "Only one", cấu trúc của câu hỏi vẫn phải đúng ngữ pháp.',
                rationale_en: 'The question "How many" and the verb "are" require a plural noun. Even though the answer is "Only one," the question structure must be grammatically correct.'
            },
            {
                type: 'fill-in-the-blank',
                question: '98. Give me a pac___t of milk, please.',
                correctAnswer: 'ke',
                correctAnswer_vi: 'ke',
                hint_vi: 'Từ có nghĩa là "hộp/gói". (2 ký tự)',
                rationale_vi: 'Từ đúng là "packet" (hộp giấy, gói).',
                rationale_en: 'The correct word is "packet".'
            },
            {
                type: 'multimedia',
                question: '99. I ____ MUSIC.',
                mediaType: 'audio',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/Thi_cac_cap/2020-2021/Lop4/Captruong/nghe/D3_8.mp3',
                correctAnswer: 'LIVE',
                correctAnswer_vi: 'thích',
                hint_vi: 'Nghe và điền động từ. (4 ký tự)',
                rationale_vi: 'Bài nghe nói "I LIKE MUSIC" (Tôi yêu âm nhạc).',
                rationale_en: 'The audio says "I LIKE MUSIC".'
            },
            {
                type: 'rearrange',
                question: '100. My sister/ playing/ is/ the teddy bear./ with/',
                words: ['My sister', 'is playing', 'with', 'the teddy bear.'],
                correctAnswer: 'My sister is playing with the teddy bear.',
                correctAnswer_vi: 'Em gái tôi đang chơi với con gấu bông.',
                hint_vi: 'Thì hiện tại tiếp diễn.',
                rationale_vi: 'Cấu trúc: S + is playing + with + O.',
                rationale_en: 'Structure: S + is playing + with + O.'
            }
        ];
        
        // --- Component: MediaDisplay (Helper for Image/Audio rendering) ---
        const MediaDisplay = ({ question, showMessage }) => {
            if (question.mediaType === 'image') {
                return (
                    <div className="w-full p-4 bg-gray-100 rounded-xl mb-4 text-center border-2 border-dashed border-gray-300">
                        <p className="text-blue-600 font-bold mb-2">🖼️ Nhìn hình và trả lời</p>
                        <img 
                            src={question.mediaSource}
                            alt={`Hình ảnh IOE: ${question.imagePrompt || 'Chủ đề câu hỏi'}`} 
                            className="w-full max-w-xs mx-auto rounded-lg shadow-md border-2 border-gray-300"
                            crossOrigin="anonymous"
                            referrerPolicy="no-referrer"
                            onError={(e) => { 
                                e.target.onerror = null; 
                                e.target.src = `https://placehold.co/566x320/FF0000/FFFFFF?text=L%E1%BB%97I+T%E1%BA%A2I+%E1%BA%A2NH+(CORS)`; 
                                showMessage('Lỗi tải ảnh: File media có thể bị chặn bởi trình duyệt.', 'error');
                            }}
                        />
                        <p className="text-xs text-gray-500 mt-2 break-all">Link gốc: {question.mediaSource}</p>
                        {question.imagePrompt && <p className="text-sm text-blue-600 mt-2 font-medium">Gợi ý nội dung: {question.imagePrompt}</p>}
                    </div>
                );
            }

            if (question.mediaType === 'audio') {
                return (
                    <div className="w-full p-4 bg-gray-100 rounded-xl mb-4 text-center border-2 border-dashed border-gray-300">
                        <p className="text-blue-600 font-bold mb-2">🔊 Nghe và trả lời (Bấm Play)</p>
                        <audio 
                            controls
                            src={question.mediaSource}
                            className="w-full max-w-sm mx-auto my-2"
                            crossOrigin="anonymous"
                            referrerPolicy="no-referrer"
                            onError={() => {
                                showMessage('Lỗi tải Audio: File media có thể bị chặn.', 'error');
                            }}
                        >
                            <source src={question.mediaSource} type="audio/mp3" />
                            Trình duyệt của bạn không hỗ trợ phần tử audio.
                        </audio>
                        <p className="text-xs text-gray-500 mt-2 break-all">Link gốc: {question.mediaSource}</p>
                    </div>
                );
            }
            return null;
        }

        // --- Component: ProgressBar.tsx ---
        const ProgressBar = ({ percentage }) => {
            return (
                <div className="w-full h-2 bg-blue-100 rounded-full mt-4 overflow-hidden">
                    <div
                        className="h-full bg-blue-500 transition-all duration-500 ease-in-out"
                        style={{ width: `${percentage}%` }}
                    ></div>
                </div>
            );
        };
        
        // --- Component: MessageBox.tsx ---
        const MessageBox = ({ message, type }) => {
            const [visible, setVisible] = React.useState(false);

            React.useEffect(() => {
                if (message) {
                    setVisible(true);
                    const timer = setTimeout(() => {
                        setVisible(false);
                    }, 2700);
                    return () => clearTimeout(timer);
                } else {
                    setVisible(false);
                }
            }, [message, type]);

            const baseClasses = "fixed top-4 left-1/2 -translate-x-1/2 p-4 rounded-xl shadow-xl text-center font-bold text-lg z-50 transition-all duration-300 transform";
            
            const typeClasses = {
                success: 'bg-green-100 border border-green-500 text-green-800',
                error: 'bg-red-100 border-red-500 text-red-800',
                info: 'bg-yellow-100 border border-yellow-500 text-yellow-800',
            };

            const visibilityClasses = visible ? 'opacity-100 scale-100' : 'opacity-0 scale-90 pointer-events-none';

            return (
                <div className={`${baseClasses} ${typeClasses[type]} ${visibilityClasses}`}>
                    {message}
                </div>
            );
        };
        
        // --- Component: RationaleBox.tsx ---
        const RationaleBox = ({ question, isCorrect, submittedAnswer }) => {
            const boxClasses = `mt-6 p-4 rounded-xl border transition duration-300 fade-in border-l-4 ${
                isCorrect ? 'bg-green-100 border-green-600' : 'bg-red-100 border-red-600'
            }`;
            
            const submittedAnswerDisplay = () => {
                const isFillIn = question.type === 'fill-in-the-blank' || (question.type === 'multimedia' && !question.options);
                
                if(isCorrect && !isFillIn) return null;
                
                return (
                    <>
                        <strong className="text-gray-700">
                           Bạn đã chọn/Điền:
                        </strong>
                        <span className="text-red-700 font-medium break-words"> {submittedAnswer}</span>
                        <br/>
                    </>
                );
            }

            return (
                <div className={boxClasses}>
                    <p className="font-bold text-lg mb-2 text-blue-700">Giải thích:</p>
                    <div className="text-gray-700 space-y-1">
                        {!isCorrect && submittedAnswerDisplay()}
                        <p><strong>Đáp án đúng:</strong> <span className="text-green-800 font-semibold">{question.correctAnswer}</span></p>
                        
                        {question.correctAnswer_vi && (
                            <p><strong>Dịch nghĩa:</strong> <span className="text-green-600 font-medium">{question.correctAnswer_vi}</span></p>
                        )}
                        <p className="pt-2 border-t border-gray-300 mt-2">{question.rationale_vi || 'Không có giải thích chi tiết.'}</p>
                    </div>
                </div>
            );
        };

        // --- Component: FillInTheBlankQuestion.tsx ---
        const FillInTheBlankQuestion = ({ question, isAnswered, onSubmit, showMessage, questionIndex }) => {
            const [inputValue, setInputValue] = React.useState('');
            const inputRef = React.useRef(null);

            React.useEffect(() => {
                setInputValue('');
                if (inputRef.current && !isAnswered) {
                    inputRef.current.focus();
                }
            }, [question, isAnswered]);

            const handleSubmitClick = () => {
                const trimmedInput = inputValue.trim();
                if (trimmedInput === '') {
                    showMessage('Vui lòng điền câu trả lời của bạn!', 'info');
                    return;
                }
                const isCorrect = trimmedInput.toLowerCase() === question.correctAnswer.toLowerCase();
                onSubmit(trimmedInput, isCorrect);
            };
            
            const questionTextParts = React.useMemo(() => {
                let text = question.question.replace(/^\d+\.\s*/, '');
                
                const markers = ['____', '________', '__________', '___________', '_________', '_______', '______', '_____', '___', '__', '_'];

                for (const marker of markers) {
                    if (text.includes(marker)) {
                        const parts = text.split(marker);
                        return [parts[0], parts.slice(1).join(marker)];
                    }
                }
                 // Handle partial words like `c__se`
                const partialMatch = text.match(/(.*)__+(.*)/) || text.match(/(.*)\_+(.*)/);
                if (partialMatch) {
                    return [partialMatch[1], partialMatch[2]];
                }

                return [text, '']; 
            }, [question.question]);
            
            let inputClasses = 'inline-block mx-2 p-2 border-2 rounded-lg text-xl text-center shadow-sm transition duration-200 align-baseline w-48 font-mono font-bold';
            if (isAnswered) {
                const isSubmissionCorrect = inputValue.trim().toLowerCase() === question.correctAnswer.toLowerCase();
                inputClasses += isSubmissionCorrect ? ' border-green-500 bg-green-50' : ' border-red-500 bg-red-50';
            } else {
                inputClasses += ' border-gray-300 focus:border-blue-500';
            }

            const inputWidthStyle = {
                width: `${Math.max(6, question.correctAnswer.length * 2)}rem`, 
                maxWidth: '100%',
            };


            return (
                <div className="space-y-4">
                     {question.mediaType && <MediaDisplay question={question} showMessage={showMessage} />}
                    <div className="text-2xl sm:text-3xl font-bold mb-6 leading-relaxed text-center flex justify-center items-center flex-wrap">
                        <span className="mr-2">{questionIndex + 1}.</span>
                        {questionTextParts[0] && <span>{questionTextParts[0]}</span>}
                        <input
                            ref={inputRef}
                            type="text"
                            value={inputValue}
                            onChange={(e) => setInputValue(e.target.value)}
                            disabled={isAnswered}
                            placeholder={isAnswered ? question.correctAnswer : ""}
                            className={inputClasses}
                            style={inputWidthStyle}
                            onKeyPress={(e) => e.key === 'Enter' && !isAnswered && handleSubmitClick()}
                            aria-label="Fill in the blank"
                        />
                        {questionTextParts[1] && <span>{questionTextParts[1]}</span>}
                    </div>
                    <button
                        onClick={handleSubmitClick}
                        disabled={isAnswered}
                        className="w-full py-3 px-4 bg-green-600 text-white font-extrabold text-xl rounded-lg shadow-md transition duration-300 hover:bg-green-700 mt-4 disabled:bg-gray-400 disabled:cursor-not-allowed active:scale-98"
                    >
                        Kiểm Tra
                    </button>
                </div>
            );
        };
        
        // --- Component: MultipleChoiceQuestion.tsx ---
        const MultipleChoiceQuestion = ({ question, isAnswered, onSubmit, showMessage, questionIndex }) => {
            const [selectedIndex, setSelectedIndex] = React.useState(null);

            React.useEffect(() => {
                setSelectedIndex(null);
            }, [question]);

            const handleSubmitClick = () => {
                if (selectedIndex === null) {
                    showMessage('Vui lòng chọn một đáp án!', 'info');
                    return;
                }
                const selectedOption = question.options[selectedIndex];
                onSubmit(selectedOption.text, selectedOption.isCorrect);
            };

            return (
                <>
                    {question.mediaType && <MediaDisplay question={question} showMessage={showMessage} />}
                    
                    <h3
                        className="text-2xl sm:text-3xl font-bold mb-6 leading-relaxed"
                        dangerouslySetInnerHTML={{ __html: `${questionIndex + 1}. ${question.question.replace(/^\d+\.\s*/, '')}` }}
                    />
                    <div className="space-y-4">
                        <div className="space-y-3">
                            {question.options.map((option, index) => {
                                const isSelected = selectedIndex === index;
                                let labelClasses = "block p-4 border-2 rounded-xl shadow-md text-xl font-bold transition duration-200";

                                if (isAnswered) {
                                    labelClasses += " cursor-default";
                                    if (option.isCorrect) {
                                        labelClasses += " bg-green-100 border-green-500";
                                    } else if (isSelected) {
                                        labelClasses += " bg-red-100 border-red-500";
                                    } else {
                                        labelClasses += " border-gray-200 opacity-60";
                                    }
                                } else {
                                    labelClasses += " cursor-pointer hover:bg-blue-50 hover:border-blue-300";
                                    if(isSelected) {
                                        labelClasses += " bg-blue-100 border-blue-500";
                                    } else {
                                        labelClasses += " border-gray-200";
                                    }
                                }

                                return (
                                    <div key={index} className="relative">
                                        <input
                                            type="radio"
                                            id={`option-${questionIndex}-${index}`}
                                            name={`mc-option-${questionIndex}`}
                                            value={index}
                                            className="hidden"
                                            checked={isSelected}
                                            onChange={() => setSelectedIndex(index)}
                                            disabled={isAnswered}
                                        />
                                        <label htmlFor={`option-${questionIndex}-${index}`} className={labelClasses} dangerouslySetInnerHTML={{ __html: option.text }}></label>
                                    </div>
                                );
                            })}
                        </div>
                        <button
                            onClick={handleSubmitClick}
                            disabled={isAnswered}
                            className="w-full py-3 px-4 bg-green-600 text-white font-extrabold text-xl rounded-lg shadow-md transition duration-300 hover:bg-green-700 mt-4 disabled:bg-gray-400 disabled:cursor-not-allowed active:scale-98"
                        >
                            Kiểm Tra
                        </button>
                    </div>
                </>
            );
        };
        
        // --- Component: RearrangeQuestion.tsx ---
        const WordBlock = ({ word, onClick, isSource, isAnswered }) => {
            const baseClasses = 'word-block px-4 py-2 text-xl font-bold rounded-lg shadow-sm transition-all duration-150 break-words transform active:scale-95';
            const sourceClasses = isSource ? 'bg-blue-100 text-blue-800 hover:bg-blue-200' : 'bg-gray-100 text-gray-800 border-b-2 border-gray-300';
            const disabledClasses = 'opacity-60 cursor-default shadow-inner';
            const interactiveClasses = 'cursor-pointer';

            return (
                <span
                    onClick={!isAnswered ? onClick : undefined}
                    className={`${baseClasses} ${sourceClasses} ${isAnswered ? disabledClasses : interactiveClasses}`}
                >
                    {word.text}
                </span>
            );
        };

        const RearrangeQuestion = ({ question, isAnswered, onSubmit, showMessage, questionIndex, isCorrect }) => {
            const [sentenceWords, setSentenceWords] = React.useState([]);
            
            const initialSourceWords = React.useMemo(() => {
                return [...question.words]
                    .map((text) => ({ id: crypto.randomUUID(), text })) 
                    .sort(() => Math.random() - 0.5);
            }, [question]);

            const [sourceWords, setSourceWords] = React.useState(initialSourceWords);

            React.useEffect(() => {
                setSourceWords(initialSourceWords);
                setSentenceWords([]);
            }, [initialSourceWords]);

            const handleSelectWord = (word) => {
                setSourceWords(prev => prev.filter(w => w.id !== word.id));
                setSentenceWords(prev => [...prev, word]);
            };

            const handleReturnWord = (word) => {
                setSentenceWords(prev => prev.filter(w => w.id !== word.id));
                setSourceWords(prev => [...prev, word].sort((a, b) => initialSourceWords.findIndex(sw => sw.id === a.id) - initialSourceWords.findIndex(sw => sw.id === b.id)));
            };

            const handleSubmitClick = () => {
                if (sentenceWords.length === 0) {
                    showMessage('Vui lòng sắp xếp các từ!', 'info');
                    return;
                }
                
                const submitted = sentenceWords.map(w => w.text).join(' ').replace(/\s+([.,?!])/g, '$1').trim();
                const normalize = (str) => str.replace(/’/g, "'").replace(/[.,?!]/g, '').replace(/\s+/g, ' ').toLowerCase().trim();
                
                const isCorrectResult = normalize(submitted) === normalize(question.correctAnswer);
                onSubmit(submitted, isCorrectResult);
            };

            return (
                <>
                    <h3
                        className="text-2xl sm:text-3xl font-bold mb-6 leading-relaxed"
                        dangerouslySetInnerHTML={{ __html: `${questionIndex + 1}. ${question.question.replace(/^\d+\.\s*/, '')}` }}
                    />
                    <div className="space-y-4">
                        <div className={`min-h-[70px] p-3 border-2 rounded-xl shadow-inner flex flex-wrap gap-2 items-center transition duration-300 ${isAnswered ? (isCorrect ? 'border-green-500 bg-green-50' : 'border-red-500 bg-red-50') : 'border-blue-300 bg-blue-50 border-dashed'}`}>
                            {sentenceWords.length === 0 && !isAnswered ? (
                                <span className="text-gray-500 italic text-base">Chạm vào các từ bên dưới để xây dựng câu trả lời...</span>
                            ) : (
                                sentenceWords.map(word => (
                                    <WordBlock key={word.id} word={word} onClick={() => handleReturnWord(word)} isSource={false} isAnswered={isAnswered} />
                                ))
                            )}
                        </div>
                        
                        <div className="min-h-[120px] p-4 bg-gray-100 rounded-xl shadow-md flex flex-wrap gap-2 items-center border border-gray-200">
                            {sourceWords.map(word => (
                                <WordBlock key={word.id} word={word} onClick={() => handleSelectWord(word)} isSource={true} isAnswered={isAnswered} />
                            ))}
                        </div>
                        <button
                            onClick={handleSubmitClick}
                            disabled={isAnswered}
                            className="w-full py-3 px-4 bg-green-600 text-white font-extrabold text-xl rounded-lg shadow-md transition duration-300 hover:bg-green-700 mt-4 disabled:bg-gray-400 disabled:cursor-not-allowed active:scale-98"
                        >
                            Kiểm Tra
                        </button>
                    </div>
                </>
            );
        };
        
        // --- Component: StartScreen.tsx ---
        const StartScreen = ({ onStart, totalQuestions, testName }) => {
            const [name, setName] = React.useState('');

            const handleStart = () => {
                if (name.trim()) {
                    onStart(name.trim());
                }
            };

            const isButtonDisabled = name.trim() === '';

            return (
                <div className="fade-in text-center p-4">
                    <header className="mb-8">
                        <h1 className="text-4xl sm:text-5xl font-extrabold text-blue-600 mb-2">{testName}</h1>
                        <p className="text-xl text-gray-500">Bộ đề luyện thi IOE dành cho khối 4</p>
                    </header>
                    <div className="max-w-md mx-auto bg-white p-6 rounded-xl shadow-lg border border-gray-100">
                        <h2 className="text-2xl font-bold mb-4 text-gray-700">Chào mừng bạn!</h2>
                        <p className="text-gray-600 mb-6 text-lg">Mỗi câu trả lời đúng được cộng 10 điểm. Bài thi có {totalQuestions} câu.</p>
                        <div className="space-y-4">
                            <label htmlFor="player-name" className="block text-base font-medium text-gray-700 text-left">Nhập tên của bạn để bắt đầu:</label>
                            <input
                                type="text"
                                id="player-name"
                                placeholder="Tên của bạn"
                                className="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 text-lg shadow-sm transition duration-150"
                                maxLength={50}
                                value={name}
                                onChange={(e) => setName(e.target.value)}
                                onKeyPress={(e) => e.key === 'Enter' && !isButtonDisabled && handleStart()}
                            />
                            <button
                                onClick={handleStart}
                                disabled={isButtonDisabled}
                                className="w-full py-3 px-4 bg-yellow-400 text-yellow-900 font-extrabold rounded-xl shadow-lg transition duration-300 hover:bg-yellow-500 disabled:bg-gray-300 disabled:cursor-not-allowed text-2xl active:scale-98"
                            >
                                Bắt Đầu
                            </button>
                        </div>
                    </div>
                </div>
            );
        };
        
        // --- Component: EndScreen.tsx ---
        const EndScreen = ({ playerName, score, totalQuestions, onRestart, onReview, testName }) => {
            const maxScore = totalQuestions * 10;
            const percentage = maxScore > 0 ? (score / maxScore) * 100 : 0;
            
            let encouragement = "Cố gắng hơn ở lần sau nhé!";
            if (percentage >= 90) {
                encouragement = "Xuất sắc! Bạn thật là giỏi!";
            } else if (percentage >= 70) {
                encouragement = "Làm tốt lắm! Chỉ cần cố gắng thêm một chút nữa thôi.";
            } else if (percentage >= 50) {
                encouragement = "Khá tốt! Hãy tiếp tục ôn luyện nhé.";
            }

            return (
                <div className="text-center fade-in p-4">
                    <h2 className="text-4xl font-extrabold mb-2 text-green-600">🎉 Hoàn Thành! 🎉</h2>
                    <p className="text-2xl text-gray-700 mb-2">
                        Chúc mừng, <span className="font-extrabold text-blue-600">{playerName}</span>!
                    </p>
                    <p className="text-xl text-gray-600 mb-4">
                        Bạn đã hoàn thành bài thi <span className="font-bold text-blue-600">{testName}</span>.
                    </p>
                     <p className="text-lg text-gray-500 mb-6">{encouragement}</p>
                    <div className="bg-white p-8 rounded-xl shadow-lg inline-block border border-gray-100">
                        <p className="text-2xl font-bold mb-8 text-gray-700">Điểm số của bạn:</p>
                        <p className={`text-7xl font-black mb-10 text-blue-700`}>
                            {score} / {maxScore}
                        </p>
                    </div>
                    <div className="mt-8 flex flex-col sm:flex-row justify-center items-center gap-4">
                        {onReview && (
                             <button
                                onClick={onReview}
                                className="py-3 px-6 bg-yellow-500 text-white font-bold rounded-xl shadow-lg transition duration-300 hover:bg-yellow-600 text-lg active:scale-98"
                            >
                                Xem lại câu sai
                            </button>
                        )}
                        <button
                            onClick={onRestart}
                            className="py-3 px-6 bg-blue-500 text-white font-bold rounded-xl shadow-lg transition duration-300 hover:bg-blue-600 text-lg active:scale-98"
                        >
                            Làm lại bài thi
                        </button>
                    </div>
                </div>
            );
        };

        // --- Component: ReviewScreen.tsx ---
        const ReviewScreen = ({ incorrectAnswers, onBack, testName }) => {
            return (
                <div className="fade-in">
                    <header className="text-center mb-8">
                        <h1 className="text-4xl sm:text-5xl font-extrabold text-yellow-600 mb-2">Ôn tập các câu sai</h1>
                        <p className="text-xl text-gray-500">Bài thi: {testName}</p>
                    </header>
                    <div className="space-y-8">
                        {incorrectAnswers.map(({ question, submittedAnswer }, index) => (
                            <div key={index} className="bg-white p-6 rounded-xl shadow-lg border border-gray-100">
                                <h3 className="text-2xl sm:text-3xl font-bold mb-4 leading-relaxed"
                                    dangerouslySetInnerHTML={{ __html: `${index + 1}. ${question.question.replace(/^\d+\.\s*/, '')}` }}
                                />
                                {question.mediaType && <MediaDisplay question={question} showMessage={() => {}} />}
                                <RationaleBox question={question} isCorrect={false} submittedAnswer={submittedAnswer} />
                            </div>
                        ))}
                    </div>
                    <div className="mt-8 text-center">
                        <button
                            onClick={onBack}
                            className="py-3 px-6 bg-blue-500 text-white font-bold rounded-xl shadow-lg transition duration-300 hover:bg-blue-600 text-lg active:scale-98"
                        >
                            Quay lại màn hình điểm
                        </button>
                    </div>
                </div>
            );
        };
        
        // --- Component: QuizScreen.tsx ---
        const QuizScreen = ({ playerName, onEnd, totalQuestions, questionSet, testName }) => {
            const [currentQuestionIndex, setCurrentQuestionIndex] = React.useState(0);
            const [score, setScore] = React.useState(0);
            const [isAnswered, setIsAnswered] = React.useState(false);
            const [isCorrect, setIsCorrect] = React.useState(false);
            const [submittedAnswer, setSubmittedAnswer] = React.useState('');
            const [isHintVisible, setIsHintVisible] = React.useState(false);
            const [message, setMessage] = React.useState(null);
            const incorrectAnswersRef = React.useRef([]);
            
            const currentQuestion = questionSet[currentQuestionIndex];

            React.useEffect(() => {
                incorrectAnswersRef.current = [];
            }, [questionSet]);

             React.useEffect(() => {
                setIsAnswered(false);
                setIsCorrect(false);
                setSubmittedAnswer('');
                setIsHintVisible(false);
                setMessage(null);
            }, [currentQuestionIndex]);
            
            const showMessage = (text, type) => {
                setMessage({ text, type });
            };

            const handleSubmit = (answer, isAnswerCorrect) => {
                if (isAnswered) return;
                
                setIsAnswered(true);
                setSubmittedAnswer(answer);
                setIsCorrect(isAnswerCorrect);

                if (isAnswerCorrect) {
                    setScore(prev => prev + 10);
                    showMessage('CHÍNH XÁC! +10 điểm', 'success');
                } else {
                    showMessage('SAI RỒI! Hãy xem lại nhé.', 'error');
                    incorrectAnswersRef.current.push({ question: currentQuestion, submittedAnswer: answer });
                }
            };

            const handleNext = () => {
                if (currentQuestionIndex < totalQuestions - 1) {
                    setCurrentQuestionIndex(prev => prev + 1);
                } else {
                    onEnd(score, incorrectAnswersRef.current);
                }
            };

            if (!currentQuestion) {
                return <div className="text-center p-8">Đang tải câu hỏi...</div>;
            }

            const progressPercentage = ((currentQuestionIndex + 1) / totalQuestions) * 100;
            
            const renderQuestionComponent = () => {
                const commonProps = {
                    question: currentQuestion,
                    isAnswered,
                    onSubmit: handleSubmit,
                    showMessage,
                    questionIndex: currentQuestionIndex,
                    isCorrect: isCorrect, 
                };

                if (currentQuestion.type === 'rearrange') {
                    return <RearrangeQuestion {...commonProps} />;
                }
                if (currentQuestion.type === 'mc' || (currentQuestion.type === 'multimedia' && currentQuestion.options)) {
                    return <MultipleChoiceQuestion {...commonProps} />;
                }
                if (currentQuestion.type === 'fill-in-the-blank' || (currentQuestion.type === 'multimedia' && !currentQuestion.options)) {
                    return <FillInTheBlankQuestion {...commonProps} />;
                }
                
                return <div className="text-red-500">Lỗi: Loại câu hỏi không xác định.</div>;
            };

            return (
                <div className="fade-in">
                    {message && <MessageBox message={message.text} type={message.type} />}
                    <header className="text-center mb-8">
                        <h1 className="text-4xl sm:text-5xl font-extrabold text-blue-600 mb-2">{testName}</h1>
                        <ProgressBar percentage={progressPercentage} />
                    </header>

                    <div className="flex justify-between items-center mb-6 py-2 px-4 bg-blue-50 rounded-xl shadow-inner border border-blue-100">
                        <p className="text-lg font-medium text-blue-800">Bạn: <span className="font-bold">{playerName}</span></p>
                        <p className="text-lg font-medium text-blue-800">Điểm: <span className="text-2xl font-extrabold text-red-600">{score}</span></p>
                        <p className="text-lg font-medium text-blue-800">Câu: <span className="font-bold">{currentQuestionIndex + 1}/{totalQuestions}</span></p>
                    </div>

                    <div className="mb-8">
                        {renderQuestionComponent()}
                    </div>

                    <div className="mt-8 border-t pt-6 flex justify-between items-center flex-wrap gap-4">
                        <div className="relative">
                            <button
                                className="bg-yellow-500 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300 hover:bg-yellow-600 active:scale-95"
                                onMouseEnter={() => setIsHintVisible(true)}
                                onMouseLeave={() => setIsHintVisible(false)}
                                onTouchStart={() => setIsHintVisible(true)}
                                onTouchEnd={() => setIsHintVisible(false)}
                            >
                                Gợi ý
                            </button>
                            <div className={`absolute bottom-full mb-2 w-max max-w-[90vw] sm:max-w-sm p-4 bg-yellow-100 border-l-4 border-yellow-500 rounded-xl shadow-lg transition-all duration-300 transform origin-bottom-left ${isHintVisible ? 'opacity-100 scale-100' : 'opacity-0 scale-90 pointer-events-none'}`}>
                                <p className="font-semibold text-yellow-800">Gợi ý:</p>
                                <p className="text-yellow-700">{currentQuestion.hint_vi || 'Không có gợi ý.'}</p>
                            </div>
                        </div>
                        
                        <button onClick={handleNext} disabled={!isAnswered} className="flex-grow py-3 px-4 bg-blue-500 text-white font-extrabold text-xl rounded-xl shadow-xl transition duration-300 hover:bg-blue-600 disabled:bg-gray-400 disabled:cursor-not-allowed active:scale-98">
                            {currentQuestionIndex === totalQuestions - 1 ? 'Hoàn thành' : 'Câu tiếp theo'}
                        </button>
                    </div>

                    {isAnswered && (
                        <RationaleBox question={currentQuestion} isCorrect={isCorrect} submittedAnswer={submittedAnswer} />
                    )}
                </div>
            );
        };
        
        // --- Component: App.tsx ---
        const App = () => {
            const [gameState, setGameState] = React.useState('start');
            const [playerName, setPlayerName] = React.useState('');
            const [score, setScore] = React.useState(0);
            const [shuffledQuestions, setShuffledQuestions] = React.useState([]);
            const [incorrectAnswers, setIncorrectAnswers] = React.useState([]);
            const testName = "BỘ ĐỀ ÔN IOE K4 SỐ: 01.2";

            React.useEffect(() => {
                const array = [...questions];
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                setShuffledQuestions(array);
            }, []);

            const handleStartQuiz = (name) => {
                setPlayerName(name);
                setScore(0);
                setIncorrectAnswers([]);
                setGameState('quiz');
            };

            const handleEndQuiz = (finalScore, mistakes) => {
                setScore(finalScore);
                setIncorrectAnswers(mistakes);
                setGameState('end');
            };
            
            const handleRestartQuiz = () => {
                 const array = [...questions];
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                setShuffledQuestions(array);
                setGameState('start');
            };

            const handleReview = () => {
                setGameState('review');
            };

             const handleBackToEndScreen = () => {
                setGameState('end');
            };

            const renderContent = () => {
                switch (gameState) {
                    case 'quiz':
                        return <QuizScreen 
                                    playerName={playerName} 
                                    onEnd={handleEndQuiz} 
                                    totalQuestions={shuffledQuestions.length}
                                    questionSet={shuffledQuestions}
                                    testName={testName}
                                />;
                    case 'end':
                        return <EndScreen 
                                    playerName={playerName} 
                                    score={score} 
                                    totalQuestions={shuffledQuestions.length}
                                    onRestart={handleRestartQuiz} 
                                    onReview={incorrectAnswers.length > 0 ? handleReview : null}
                                    testName={testName}
                                />;
                    case 'review':
                        return <ReviewScreen 
                                    incorrectAnswers={incorrectAnswers}
                                    onBack={handleBackToEndScreen}
                                    testName={testName}
                                />;
                    default:
                         return <StartScreen onStart={handleStartQuiz} totalQuestions={questions.length} testName={testName} />;
                }
            };

            return (
                <div className="p-4 sm:p-8 flex justify-center items-start min-h-screen">
                    <div className="w-full max-w-3xl bg-white rounded-xl shadow-2xl p-6 sm:p-8 md:p-10 border border-gray-100 min-h-[80vh]">
                        {renderContent()}
                    </div>
                </div>
            );
        };
        
        // --- Entry point from index.tsx ---
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);

    </script>
</body>
</html>
